#!/bin/bash
# MLX Server wrapper script

# Get the directory where this script is located
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Use bundled environment if MLX_ENV_PATH is set, otherwise look for it relative to script
if [ -z "$MLX_ENV_PATH" ]; then
    MLX_ENV_PATH="${SCRIPT_DIR}/mlx-env"
fi

# Check if the environment exists
if [ ! -d "$MLX_ENV_PATH" ]; then
    echo "Error: MLX environment not found at $MLX_ENV_PATH"
    exit 1
fi

# Run the MLX server with the bundled Python
exec "${MLX_ENV_PATH}/bin/python" "${SCRIPT_DIR}/mlx_server.py" "$@"
